<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<sqls id="StrikeSqls" longname="冲正相关sql" package="cn.sunline.ltts.busi.aptran.namedsql" xsi:noNamespaceSchemaLocation="ltts-model.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <description><![CDATA[冲正相关sql]]></description>
    <select cache="none" method="selectOne" type="sql" id="seltransInfoByTransq" longname="根据流水查询交易信息">
        <sql type="oracle"><![CDATA[
        select a.zjyilush,a.jiaoyirq,a.jiaoyigy,a.jiaoyisj,a.jiaoyima,a.jiaoyikh,a.jiaoyizh,a.jiaoyije,a.jiaoyilx,b.jiaoyimc 
		from kaps_zjyils a ,kapp_jioyxx b where a.jiaoyima = b.jiaoyima and a.zjyilush = #transq#]]></sql>
        <sql type="mysql"><![CDATA[
        select a.zjyilush,a.jiaoyirq,a.jiaoyigy,a.jiaoyisj,a.jiaoyima,a.jiaoyikh,a.jiaoyizh,a.jiaoyije,a.jiaoyilx,b.jiaoyimc 
		from kaps_zjyils a ,kapp_jioyxx b where a.jiaoyima = b.jiaoyima and a.zjyilush = #transq#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="transq" ref="DpDict.Acct.transq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="主交易流水" parameterType="condition"/>
        </parameterMap>
        <resultMap class="TransInfo.MainTransInfo"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selGlKnaAcct" longname="查询内部户">
        <sql><![CDATA[select * from gl_kna_acct where acctno=#acctno# and corpno=#corpno#]]></sql>
        <sql type="mysql"><![CDATA[select * from gl_kna_acct where acctno=#acctno# and corpno=#corpno#]]></sql>
        <sql type="oracle"><![CDATA[select * from gl_kna_acct where acctno=#acctno# and corpno=#corpno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="acctno" jdbcType="VARCHAR" javaType="BaseType.U_ACCTNO" mode="in" longname="内部户账号" parameterType="condition"/>
            <parameter property="corpno" ref="ApDict.Aplt.corpno" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoInTable.IoGlKnaAcct"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selknaacdc" longname="查询内部户卡">
        <sql><![CDATA[select * from kna_acdc  where custac=#custac# and status=#status# and corpno=#corpno#]]></sql>
        <sql type="mysql"><![CDATA[select * from kna_acdc  where custac=#custac# and status=#status# and corpno=#corpno#]]></sql>
        <sql type="oracle"><![CDATA[select * from kna_acdc  where custac=#custac# and status=#status# and corpno=#corpno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="status" jdbcType="VARCHAR" javaType="BaseEnumType.E_DPACST" mode="in" longname="状态" parameterType="condition"/>
            <parameter property="corpno" ref="ApDict.Aplt.corpno" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTable.IoCaKnaAcdc"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnaCustBycustac" longname="查询账号户名">
        <sql><![CDATA[select * from kna_cust where custac=#custac# and corpno=#corpno#]]></sql>
        <sql type="mysql"><![CDATA[select * from kna_cust where custac=#custac# and corpno=#corpno#]]></sql>
        <sql type="oracle"><![CDATA[select * from kna_cust where custac=#custac# and corpno=#corpno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
            <parameter property="corpno" ref="ApDict.Aplt.corpno" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTable.IoCaKnaCust"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selknpbusi" longname="查询业务编码">
        <sql type="mysql"><![CDATA[select * from gl_knp_busi a where a.busino=#cuacno# and corpno=#corpno#]]></sql>
        <sql type="oracle"><![CDATA[select * from gl_knp_busi a where a.busino=#cuacno# and corpno=#corpno#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="cuacno" jdbcType="VARCHAR" javaType="string" mode="in" longname="业务编码" parameterType="condition"/>
            <parameter property="corpno" ref="ApDict.Aplt.corpno" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoInTable.IoGlKnpBusi"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selCustidByCustac1" longname="根据电子账户查询客户ID">
        <sql type="mysql"><![CDATA[select a.custid from cif_cust_accs a , kna_cust b where a.custno = b.custno and b.custac= #custac#]]></sql>
        <sql type="oracle"><![CDATA[select a.custid from cif_cust_accs a , kna_cust b where a.custno = b.custno and b.custac= #custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="CaDict.Eacct.custac" jdbcType="VARCHAR" javaType="BaseType.U_CUACNO" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.lang.String"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnbEvnt" longname="通过交易流水查询业务事件登记薄">
        <sql><![CDATA[SELECT * FROM  knb_evnt where trandt = #trandt# and transq = #transq#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="trandt" ref="BaseDict.Comm.trandt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="transq" ref="BaseDict.Comm.transq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="交易流水" parameterType="condition"/>
        </parameterMap>
        <resultMap class="SysBusiTable.KnbEvnt"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKnlBillByTransq" longname="通过交易流水查询账户余额发生明细">
        <sql><![CDATA[SELECT * FROM  knl_bill WHERE transq = #transq#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="transq" ref="BaseDict.Comm.transq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="交易流水" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoDpTable.IoDpKnlBill"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKupTpprByPrcscd" longname="根据交易码查询短信模板参数表">
        <sql><![CDATA[SELECT * FROM kup_tppr WHERE  prcscd = #prcscd#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="prcscd" ref="BaseDict.Comm.prcscd" jdbcType="VARCHAR" javaType="BaseType.U_PRCSCD" mode="in" longname="交易码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ApSmsType.KupTppr"/>
    </select>
    <select cache="none" method="selectFirst" type="sql" id="selknaAcalbycustac" longname="根据电子账号查询别名关系表获取生效手机号">
        <sql type="db2"><![CDATA[select a.* from kna_acal a where a.corpno=#corpno# and a.custac = #custac#  and a.acalst ='1']]></sql>
        <sql type="oracle"><![CDATA[select a.* from kna_acal a where a.corpno=#corpno# and a.custac = #custac#]]></sql>
        <sql type="mysql"><![CDATA[select a.* from kna_acal a where a.corpno=#corpno# and a.custac = #custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="corpno" ref="BaseDict.Comm.corpno" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="custac" jdbcType="VARCHAR" javaType="BaseType.U_CUSTAC" mode="in" longname="电子账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTable.IoCaKnaAcal"/>
    </select>
    <insert id="insertKupSmsd" longname="待发短信新增数据">
        <sql><![CDATA[insert into kup_smsd (scenmk, teleno, phpara, expara, custid, vesion, brchno, mesgst, priori, trandt, transq, btchno)
values (#scenmk#, #teleno#, #phpara#, #expara#, #custid#, #vesion#, #brchno#, #mesgst#, #priori#, #trandt#, #transq#, #btchno#)
]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="scenmk" jdbcType="VARCHAR" javaType="BaseType.U_CHAR32" mode="in" longname="场景标识" parameterType="condition"/>
            <parameter property="teleno" ref="BaseDict.Comm.teleno" jdbcType="VARCHAR" javaType="BaseType.U_TELENO" mode="in" longname="电话号码" parameterType="condition"/>
            <parameter property="phpara" jdbcType="VARCHAR" javaType="BaseType.U_CHAR1024" mode="in" longname="推送参数" parameterType="condition"/>
            <parameter property="expara" jdbcType="VARCHAR" javaType="BaseType.U_CHAR16" mode="in" longname="扩展参数" parameterType="condition"/>
            <parameter property="custid" ref="BaseDict.Comm.custid" jdbcType="VARCHAR" javaType="BaseType.U_CUSTID" mode="in" longname="用户ID" parameterType="condition"/>
            <parameter property="vesion" jdbcType="VARCHAR" javaType="BaseType.U_CHAR32" mode="in" parameterType="condition"/>
            <parameter property="brchno" ref="BaseDict.Comm.brchno" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="机构号" parameterType="condition"/>
            <parameter property="mesgst" jdbcType="VARCHAR" javaType="PbEnumType.E_MSDLST" mode="in" longname="短信状态" parameterType="condition"/>
            <parameter property="priori" jdbcType="VARCHAR" javaType="PbEnumType.E_PRIORI" mode="in" parameterType="condition"/>
            <parameter property="trandt" ref="BaseDict.Comm.trandt" jdbcType="VARCHAR" javaType="BaseType.U_DATE08" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="transq" ref="BaseDict.Comm.transq" jdbcType="VARCHAR" javaType="BaseType.U_SEQUNO" mode="in" longname="交易流水" parameterType="condition"/>
            <parameter property="btchno" ref="BaseDict.Comm.btchno" jdbcType="VARCHAR" javaType="BaseType.U_CHAR40" mode="in" longname="批量交易批次号" parameterType="condition"/>
        </parameterMap>
    </insert>
    <select cache="none" method="selectOne" type="sql" id="selKnaCacdByCustac" longname="通过电子账号查询绑定卡卡号">
        <sql><![CDATA[SELECT * from KNA_CACD where custac=#custac#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="custac" ref="BaseDict.Comm.custac" jdbcType="VARCHAR" javaType="BaseType.U_CHAR32" mode="in" longname="客户账号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTable.IoCaKnaCacd"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="selKcdProdByProdst" longname="通过产品状态查询卡产品">
        <sql><![CDATA[SELECT * from KCD_PROD where prodst=#prodst#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="prodst" jdbcType="VARCHAR" javaType="BaseEnumType.E_PRODST" mode="in" longname="产品状态" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoCaTable.IoCaKcdProd"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selKupTpprByMgtpid" longname="通过短信模板查询短信模板参数">
        <sql><![CDATA[SELECT * FROM kup_tppr WHERE  mgtpid = #mgtpid#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="mgtpid" jdbcType="VARCHAR" javaType="BaseType.U_CHAR16" mode="in" parameterType="condition"/>
        </parameterMap>
        <resultMap class="IoBrComplexType.IoKupTppr"/>
    </select>
</sqls>
