<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<sqls xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="FaFile" longname="文件相关SQL" package="cn.sunline.ltts.busi.fa.namedsql" xsi:noNamespaceSchemaLocation="ltts-model.xsd">
    <select cache="none" method="selectAll" type="sql" id="lstFileHashInfo" longname="查找文件散列值">
        <sql type="oracle"><![CDATA[
    	select
    	    	distinct a.hash_value 
    	from
    	    	apb_batch_request a 
    	join
    	    	apb_batch_receive b 
    	on      a.request_file_id = b.file_id
    	where
              a.corpno = #org_id#
    	  and a.busi_batch_type = #busi_batch_type# 
    	  and a.file_handling_status = #file_handling_status#
    	  and b.receive_ind = #receive_ind# 
    	  
    	]]></sql>
        <sql type="db2"><![CDATA[
    	select
    	    	distinct a.hash_value 
    	from
    	    	apb_batch_request a 
    	join
    	    	apb_batch_receive b 
    	on      a.request_file_id = b.file_id
    	where
              a.corpno = #org_id#
    	  and a.busi_batch_type = #busi_batch_type# 
    	  and a.file_handling_status = #file_handling_status#
    	  and b.receive_ind = #receive_ind# 
    	  
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	distinct a.hash_value 
    	from
    	    	apb_batch_request a 
    	join
    	    	apb_batch_receive b 
    	on      a.request_file_id = b.file_id
    	where
              a.corpno = #org_id#
    	  and a.busi_batch_type = #busi_batch_type# 
    	  and a.file_handling_status = #file_handling_status#
    	  and b.receive_ind = #receive_ind# 
    	  
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="busi_batch_type" ref="GlDict.A.busi_batch_type" jdbcType="VARCHAR" javaType="GlEnumType.E_BATCHTYPE" mode="in" longname="文件批量类别" parameterType="condition"/>
            <parameter property="receive_ind" ref="GlDict.A.receive_ind" jdbcType="VARCHAR" javaType="GlEnumType.E_YESORNO" mode="in" longname="文件收妥标志" parameterType="condition"/>
            <parameter property="file_handling_status" ref="GlDict.A.file_handling_status" jdbcType="VARCHAR" javaType="GlEnumType.E_FILEDEALSTATUS" mode="in" longname="文件处理状态" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ComFaApFile.ApDataGroupNo"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="lstFileDownInfo" longname="查询文件下载信息">
        <sql type="oracle"><![CDATA[
    select
    	    	a.busi_batch_code, b.file_id ,b.file_name ,b.file_local_path, c.sys_no 
    	from
    	    	apb_batch_request a 
    	join
    	    	apb_batch_receive b 
    	on      a.request_file_id = b.file_id
	join  
		app_batch c
	on	 a.busi_batch_id = c.busi_batch_id
    	where
                  a.corpno = #org_id# 
    	    	and a.hash_value = #hash_value# 
    	    	and a.busi_batch_type = #busi_batch_type# 
    	    	and a.file_handling_status = #file_handling_status#
    	    	and b.receive_ind = #receive_ind# ]]></sql>
        <sql type="db2"><![CDATA[
    select
    	    	a.busi_batch_code, b.file_id ,b.file_name ,b.file_local_path, c.sys_no 
    	from
    	    	apb_batch_request a 
    	join
    	    	apb_batch_receive b 
    	on      a.request_file_id = b.file_id
	join  
		app_batch c
	on	 a.busi_batch_id = c.busi_batch_id
    	where
                  a.corpno = #org_id# 
    	    	and a.hash_value = #hash_value# 
    	    	and a.busi_batch_type = #busi_batch_type# 
    	    	and a.file_handling_status = #file_handling_status#
    	    	and b.receive_ind = #receive_ind# ]]></sql>
        <sql type="mysql"><![CDATA[
    select
    	    	a.busi_batch_code, b.file_id ,b.file_name ,b.file_local_path, c.sys_no 
    	from
    	    	apb_batch_request a 
    	join
    	    	apb_batch_receive b 
    	on      a.request_file_id = b.file_id
	join  
		app_batch c
	on	 a.busi_batch_id = c.busi_batch_id
    	where
                  a.corpno = #org_id# 
    	    	and a.hash_value = #hash_value# 
    	    	and a.busi_batch_type = #busi_batch_type# 
    	    	and a.file_handling_status = #file_handling_status#
    	    	and b.receive_ind = #receive_ind# ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="hash_value" ref="GlDict.A.hash_value" jdbcType="VARCHAR" javaType="GlBaseType.U_LONG" mode="in" longname="散列值" parameterType="condition"/>
            <parameter property="busi_batch_type" ref="GlDict.A.busi_batch_type" jdbcType="VARCHAR" javaType="GlEnumType.E_BATCHTYPE" mode="in" longname="文件批量类别" parameterType="condition"/>
            <parameter property="file_handling_status" ref="GlDict.A.file_handling_status" jdbcType="VARCHAR" javaType="GlEnumType.E_FILEDEALSTATUS" mode="in" longname="文件处理状态" parameterType="condition"/>
            <parameter property="receive_ind" ref="GlDict.A.receive_ind" jdbcType="VARCHAR" javaType="GlEnumType.E_YESORNO" mode="in" longname="文件收妥标志" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ComFaFile.FaFileDown"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="lstGroupIdForRecv" longname="获取文件接收的散列值">
        <sql type="oracle"><![CDATA[      select
                distinct a.hash_value
        from
                apb_batch_receive a 
        where                
              a.receive_ind = #receive_ind#  ]]></sql>
        <sql type="db2"><![CDATA[      select
                distinct a.hash_value
        from
                apb_batch_receive a 
        where                
              a.receive_ind = #receive_ind#  ]]></sql>
        <sql type="mysql"><![CDATA[      select
                distinct a.hash_value
        from
                apb_batch_receive a 
        where                
              a.receive_ind = #receive_ind#  ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="receive_ind" ref="GlDict.A.receive_ind" jdbcType="VARCHAR" javaType="GlEnumType.E_YESORNO" mode="in" longname="receive indication" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ComFaApFile.ApDataGroupNo"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="lstFileReceiveData" longname="文件接收数据集">
        <sql type="oracle"><![CDATA[      
        select
                a.file_id ,a.file_name,a.file_server_path,a.file_local_path
        from
                apb_batch_receive a 
        where
              a.hash_value = #hash_value#        
              and a.receive_ind = #receive_ind# 
              and a.corpno = #org_id#
       order by  a.recevice_count asc
        ]]></sql>
        <sql type="db2"><![CDATA[      
        select
                a.file_id ,a.file_name,a.file_server_path,a.file_local_path
        from
                apb_batch_receive a 
        where
              a.hash_value = #hash_value#        
              and a.receive_ind = #receive_ind# 
              and a.corpno = #org_id#
       order by  a.recevice_count asc
        ]]></sql>
        <sql type="mysql"><![CDATA[      
        select
                a.file_id ,a.file_name,a.file_server_path,a.file_local_path
        from
                apb_batch_receive a 
        where
              a.hash_value = #hash_value#        
              and a.receive_ind = #receive_ind# 
              and a.corpno = #org_id#
       order by  a.recevice_count asc
        ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="hash_value" ref="GlDict.A.hash_value" jdbcType="VARCHAR" javaType="GlBaseType.U_LONG" mode="in" longname="hash value" parameterType="condition"/>
            <parameter property="file_handling_status" ref="GlDict.A.file_handling_status" jdbcType="VARCHAR" javaType="GlEnumType.E_FILEDEALSTATUS" mode="in" longname="file deal status" parameterType="condition"/>
            <parameter property="receive_ind" ref="GlDict.A.receive_ind" jdbcType="VARCHAR" javaType="GlEnumType.E_YESORNO" mode="in" longname="receive indication" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ComFaApFile.ApRecvFileIn"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="lstGroupIdForSend" longname="获取文件发送的散列值">
        <sql type="oracle"><![CDATA[      select
                distinct a.hash_value
        from
                apb_batch_send a 
        where
              a.send_ind = #send_ind#  ]]></sql>
        <sql type="db2"><![CDATA[      select
                distinct a.hash_value
        from
                apb_batch_send a 
        where
              a.send_ind = #send_ind#  ]]></sql>
        <sql type="mysql"><![CDATA[      select
                distinct a.hash_value
        from
                apb_batch_send a 
        where
              a.send_ind = #send_ind#  ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="send_ind" ref="GlDict.A.send_ind" jdbcType="VARCHAR" javaType="GlEnumType.E_YESORNO" mode="in" longname="send indication" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ComFaApFile.ApDataGroupNo"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="lstFileSendData" longname="文件发送数据集">
        <sql type="oracle"><![CDATA[      select
                a.file_id ,a.file_name,a.file_server_path,a.file_local_path,a.append_ok_ind
        from
                apb_batch_send a 
        where
              a.hash_value = #hash_value# 
              and a.send_ind = #send_ind# 
       order  by  a.send_count  asc
        ]]></sql>
        <sql type="db2"><![CDATA[      select
                a.file_id ,a.file_name,a.file_server_path,a.file_local_path,a.append_ok_ind
        from
                apb_batch_send a 
        where
              a.hash_value = #hash_value# 
              and a.send_ind = #send_ind# 
       order  by  a.send_count  asc
        ]]></sql>
        <sql type="mysql"><![CDATA[      select
                a.file_id ,a.file_name,a.file_server_path,a.file_local_path,a.append_ok_ind
        from
                apb_batch_send a 
        where
              a.hash_value = #hash_value# 
              and a.send_ind = #send_ind# 
       order  by  a.send_count  asc
        ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="hash_value" ref="GlDict.A.hash_value" jdbcType="VARCHAR" javaType="GlBaseType.U_LONG" mode="in" longname="hash value" parameterType="condition"/>
            <parameter property="send_ind" ref="GlDict.A.send_ind" jdbcType="VARCHAR" javaType="GlEnumType.E_YESORNO" mode="in" longname="send indication" parameterType="condition"/>
        </parameterMap>
        <resultMap class="ComFaApFile.ApSendFileIn"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="lstSyscBatchIdList" longname="获取批量同步文件清单">
        <sql type="oracle"><![CDATA[
        select
                * 
        from
                app_batch 
        where
                file_proc_type = #file_proc_type# and file_recv_way = #file_recv_way#
        ]]></sql>
        <sql type="db2"><![CDATA[
        select
                * 
        from
                app_batch 
        where
                file_proc_type = #file_proc_type# and file_recv_way = #file_recv_way#
        ]]></sql>
        <sql type="mysql"><![CDATA[
        select
                * 
        from
                app_batch 
        where
                file_proc_type = #file_proc_type# and file_recv_way = #file_recv_way#
        ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="file_proc_type" ref="GlDict.A.file_proc_type" jdbcType="VARCHAR" javaType="GlEnumType.E_FILEPROCTYPE" mode="in" longname="file process type" parameterType="condition"/>
            <parameter property="file_recv_way" ref="GlDict.A.file_recv_way" jdbcType="VARCHAR" javaType="GlEnumType.E_FILERECVWAY" mode="in" longname="file receive way" parameterType="condition"/>
        </parameterMap>
        <resultMap class="TabFaFile.app_batch"/>
    </select>
</sqls>
