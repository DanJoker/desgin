<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<sqls xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="GlDepositPaid" longname="准备金命名sql" package="cn.sunline.ltts.busi.gl.namedsql" xsi:noNamespaceSchemaLocation="ltts-model.xsd">
    <select cache="none" method="selectOne" type="sql" id="selDepositPaidAmt" longname="统计非配减项科目余额-优化后">
        <sql type="oracle"><![CDATA[
    	SELECT
    	    	nvl(sum(case when b.calc_factor = '1' then abs(a.current_credit_bal - a.current_debit_bal)* b.reserve_percent/100 when b.calc_factor = '2' then -1*abs(a.current_credit_bal - a.current_debit_bal)*b.reserve_percent/100 end ), 0.00) as amt 
    	from
    	    	glp_reserve_index b 
    	join
    	    	glb_gl_report a 
    	    	    	on a.corpno = b.corpno and a.gl_code = b.gl_code 
    	    	    	and a.ccy_code = b.ccy_code 
    	where
    	    	a.corpno = #org_id# and a.trxn_date = #trxn_date# 
    	    	and a.ccy_code = #ccy_code# and a.report_type='1' 
    	    	and a.gl_date_interval = '1' and a.branch_id = #branch_id# 
    	    	and b.reserve_type = #reserve_type# and b.calc_factor in ('1', '2') 
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	SELECT
    	    	ifnull(sum(case when b.calc_factor = '1' then abs(a.current_credit_bal - a.current_debit_bal)* b.reserve_percent/100 when b.calc_factor = '2' then -1*abs(a.current_credit_bal - a.current_debit_bal)*b.reserve_percent/100 end ), 0.00) as amt 
    	from
    	    	glp_reserve_index b 
    	join
    	    	glb_gl_report a 
    	    	    	on a.corpno = b.corpno and a.gl_code = b.gl_code 
    	    	    	and a.ccy_code = b.ccy_code 
    	where
    	    	a.corpno = #org_id# and a.trxn_date = #trxn_date# 
    	    	and a.ccy_code = #ccy_code# and a.report_type='1' 
    	    	and a.gl_date_interval = '1' and a.branch_id = #branch_id# 
    	    	and b.reserve_type = #reserve_type# and b.calc_factor in ('1', '2') 
    	]]></sql>
        <sql type="db2"><![CDATA[
    	SELECT
    	    	value(sum(case when b.calc_factor = '1' then abs(a.current_credit_bal - a.current_debit_bal)* b.reserve_percent/100 when b.calc_factor = '2' then -1*abs(a.current_credit_bal - a.current_debit_bal)*b.reserve_percent/100 end ), 0.00) as amt 
    	from
    	    	glp_reserve_index b 
    	join
    	    	glb_gl_report a 
    	    	    	on a.corpno = b.corpno and a.gl_code = b.gl_code 
    	    	    	and a.ccy_code = b.ccy_code 
    	where
    	    	a.corpno = #org_id# and a.trxn_date = #trxn_date# 
    	    	and a.ccy_code = #ccy_code# and a.report_type='1' 
    	    	and a.gl_date_interval = '1' and a.branch_id = #branch_id# 
    	    	and b.reserve_type = #reserve_type# and b.calc_factor in ('1', '2') 
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="trxn_date" ref="GlDict.A.trxn_date" jdbcType="VARCHAR" javaType="GlBaseType.U_DATE" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="reserve_type" ref="GlDict.A.reserve_type" jdbcType="VARCHAR" javaType="GlBusinessType.E_RESERVEAMTTYPE" mode="in" longname="准备金种类" parameterType="condition"/>
            <parameter property="ccy_code" ref="GlDict.A.ccy_code" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="货币代码" parameterType="condition"/>
            <parameter property="branch_id" ref="GlDict.A.branch_id" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="机构号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="java.math.BigDecimal"/>
    </select>
    <dynamicSelect cache="none" method="selectAll" type="sql" id="lstReserveIndexDynamic" longname="动态查询准备金指标参数">
        <parameterMap class="java.util.Map">
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="reserve_type" ref="GlDict.A.reserve_type" jdbcType="VARCHAR" javaType="GlBusinessType.E_RESERVEAMTTYPE" mode="in" longname="准备金种类" parameterType="condition"/>
            <parameter property="calc_factor" ref="GlDict.A.calc_factor" jdbcType="VARCHAR" javaType="GlBusinessType.E_CALCFACTOR" mode="in" longname="计算因子" parameterType="condition"/>
            <parameter property="ccy_code" ref="GlDict.A.ccy_code" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="货币代码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="TabGLParm.glp_reserve_index"/>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select * from glp_reserve_index]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[corpno = #org_id#]]></str>
                    <if test="reserve_type!=null" type="If">
                        <str type="Str"><![CDATA[reserve_type=#reserve_type#]]></str>
                    </if>
                    <if test="calc_factor!=null" type="If">
                        <str type="Str"><![CDATA[calc_factor=#calc_factor#]]></str>
                    </if>
                    <if test="ccy_code!=null" type="If">
                        <str type="Str"><![CDATA[ccy_code=#ccy_code#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by gl_code]]></str>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select * from glp_reserve_index]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[corpno = #org_id#]]></str>
                    <if test="reserve_type!=null" type="If">
                        <str type="Str"><![CDATA[reserve_type=#reserve_type#]]></str>
                    </if>
                    <if test="calc_factor!=null" type="If">
                        <str type="Str"><![CDATA[calc_factor=#calc_factor#]]></str>
                    </if>
                    <if test="ccy_code!=null" type="If">
                        <str type="Str"><![CDATA[ccy_code=#ccy_code#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by gl_code]]></str>
        </dynamicSql>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[select * from glp_reserve_index]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[corpno = #org_id#]]></str>
                    <if test="reserve_type!=null" type="If">
                        <str type="Str"><![CDATA[reserve_type=#reserve_type#]]></str>
                    </if>
                    <if test="calc_factor!=null" type="If">
                        <str type="Str"><![CDATA[calc_factor=#calc_factor#]]></str>
                    </if>
                    <if test="ccy_code!=null" type="If">
                        <str type="Str"><![CDATA[ccy_code=#ccy_code#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by gl_code]]></str>
        </dynamicSql>
    </dynamicSelect>
    <dynamicSelect cache="none" method="selectOne" type="sql" id="selGlbGlReportDynamic" longname="动态查询总账表科目余额汇总">
        <parameterMap class="java.util.Map">
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="trxn_date" ref="GlDict.A.trxn_date" jdbcType="VARCHAR" javaType="GlBaseType.U_DATE" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="ccy_code" ref="GlDict.A.ccy_code" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="货币代码" parameterType="condition"/>
            <parameter property="gl_date_interval" ref="GlDict.A.gl_date_interval" jdbcType="VARCHAR" javaType="GlBusinessType.E_GLDATEINTERVAL" mode="in" longname="总账区间" parameterType="condition"/>
            <parameter property="report_type" ref="GlDict.A.report_type" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTTYPE" mode="in" longname="报表类型" parameterType="condition"/>
            <parameter property="branch_id" ref="GlDict.A.branch_id" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="机构号" parameterType="condition"/>
            <parameter property="gl_code" ref="GlDict.A.gl_code" jdbcType="VARCHAR" javaType="GlBaseType.U_SUBJECTNO" mode="in" longname="科目号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="decimal"/>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select nvl(sum(case b.bal_prop when '1' then  nvl(a.current_credit_bal,0.00)-nvl(a.current_debit_bal,0.00)   else nvl(a.current_debit_bal,0.00)-nvl(a.current_credit_bal,0.00) end),0.00) as amt 
            			from glb_gl_report a 
            			join fap_accounting_subject b on a.corpno = b.corpno and a.gl_code = b.gl_code ]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.corpno = #org_id#]]></str>
                    <if test="trxn_date!=null &amp;&amp; trxn_date!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trxn_date=#trxn_date#]]></str>
                    </if>
                    <if test="ccy_code!=null" type="If">
                        <str type="Str"><![CDATA[a.ccy_code=#ccy_code#]]></str>
                    </if>
                    <if test="gl_date_interval!=null" type="If">
                        <str type="Str"><![CDATA[a.gl_date_interval=#gl_date_interval#]]></str>
                    </if>
                    <if test="report_type!=null" type="If">
                        <str type="Str"><![CDATA[a.report_type=#report_type#]]></str>
                    </if>
                    <if test="branch_id!=null &amp;&amp; branch_id!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.branch_id=#branch_id#]]></str>
                    </if>
                    <if test="gl_code!=null &amp;&amp; gl_code!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.gl_code =#gl_code#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select ifnull(sum(case b.bal_prop when '1' then ifnull(a.current_credit_bal,0.00) - ifnull(a.current_debit_bal,0.00) else ifnull(a.current_debit_bal,0.00) - ifnull(a.current_credit_bal,0.00) end),0.00) as amt 
                        from glb_gl_report a 
                        join fap_accounting_subject b on a.corpno = b.corpno and a.gl_code = b.gl_code ]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.corpno = #org_id#]]></str>
                    <if test="trxn_date!=null &amp;&amp; trxn_date!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trxn_date=#trxn_date#]]></str>
                    </if>
                    <if test="ccy_code!=null" type="If">
                        <str type="Str"><![CDATA[a.ccy_code=#ccy_code#]]></str>
                    </if>
                    <if test="gl_date_interval!=null" type="If">
                        <str type="Str"><![CDATA[a.gl_date_interval=#gl_date_interval#]]></str>
                    </if>
                    <if test="report_type!=null" type="If">
                        <str type="Str"><![CDATA[a.report_type=#report_type#]]></str>
                    </if>
                    <if test="branch_id!=null &amp;&amp; branch_id!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.branch_id=#branch_id#]]></str>
                    </if>
                    <if test="gl_code!=null &amp;&amp; gl_code!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.gl_code =#gl_code#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[select value(sum(case b.bal_prop when '1' then value(a.current_credit_bal,0.00) - value(a.current_debit_bal,0.00) else value(a.current_debit_bal,0.00) - value(a.current_credit_bal,0.00) end),0.00) as amt 
                        from glb_gl_report a 
                        join fap_accounting_subject b on a.corpno = b.corpno and a.gl_code = b.gl_code ]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[a.corpno = #org_id#]]></str>
                    <if test="trxn_date!=null &amp;&amp; trxn_date!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.trxn_date=#trxn_date#]]></str>
                    </if>
                    <if test="ccy_code!=null" type="If">
                        <str type="Str"><![CDATA[a.ccy_code=#ccy_code#]]></str>
                    </if>
                    <if test="gl_date_interval!=null" type="If">
                        <str type="Str"><![CDATA[a.gl_date_interval=#gl_date_interval#]]></str>
                    </if>
                    <if test="report_type!=null" type="If">
                        <str type="Str"><![CDATA[a.report_type=#report_type#]]></str>
                    </if>
                    <if test="branch_id!=null &amp;&amp; branch_id!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.branch_id=#branch_id#]]></str>
                    </if>
                    <if test="subject_no!=null &amp;&amp; subject_no!=&quot;&quot;" type="If">
                        <str type="Str"><![CDATA[a.gl_code =#gl_code#]]></str>
                    </if>
                </and>
            </where>
        </dynamicSql>
    </dynamicSelect>
</sqls>
