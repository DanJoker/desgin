<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<sqls xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="GlReport" longname="报表相关sql" package="cn.sunline.ltts.busi.gl.namedsql" xsi:noNamespaceSchemaLocation="ltts-model.xsd">
    <delete method="delete" id="delReportCalResult" longname="删除报表计算结果">
        <sql type="mysql"><![CDATA[
    	delete a 
    	from
    	    	glb_report_calc_result a 
    	where
    	    	a.report_name=#report_name# and a.report_type=#report_type# 
    	    	and a.trxn_date=#trxn_date# and a.branch_id=#branch_id# 
    	    	and a.corpno = #org_id# 
    	]]></sql>
        <sql type="oracle"><![CDATA[
    	delete 
    	from
    	    	glb_report_calc_result 
    	where
    	    	report_name=#report_name# and report_type=#report_type# 
    	    	and trxn_date=#trxn_date# and branch_id=#branch_id# 
    	    	and corpno = #org_id# 
    	]]></sql>
        <sql type="db2"><![CDATA[
    	delete 
    	from
    	    	glb_report_calc_result 
    	where
    	    	report_name=#report_name# and report_type=#report_type# 
    	    	and trxn_date=#trxn_date# and branch_id=#branch_id# 
    	    	and corpno = #org_id# 
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="report_name" ref="GlDict.A.report_name" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTNAME" mode="in" longname="报表名称" parameterType="condition"/>
            <parameter property="report_type" ref="GlDict.A.report_type" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTTYPE" mode="in" longname="报表类型" parameterType="condition"/>
            <parameter property="trxn_date" ref="GlDict.A.trxn_date" jdbcType="VARCHAR" javaType="GlBaseType.U_DATE" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="branch_id" ref="GlDict.A.branch_id" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="机构号" parameterType="condition"/>
        </parameterMap>
    </delete>
    <select cache="none" method="selectOne" type="sql" id="selCountsFromReport" longname="查询总账是否有记账数据">
        <sql type="oracle"><![CDATA[
     	select
    	    	count(*) 
    	from
    	    	dual 
    	where
    	    	exists(
    	    	    	select
    	    	    	    	1 
    	    	    	from
    	    	    	    	glb_gl_report a 
    	    	    	where
    	    	    	    	a.corpno=#org_id# and a.report_type=#report_type# 
    	    	    	    	and a.trxn_date=#trxn_date# and a.branch_id=#branch_id# 
    	    	    	    	and a.ccy_code=#ccy_code# 
                        and a.gl_date_interval in ('1','2')
						and( current_debit_amt<>0.00 or
						current_credit_amt<>0.00 or
						current_debit_bal<>0.00 or
						current_credit_bal<>0.00
						)
    	    	)]]></sql>
        <sql type="db2"><![CDATA[
     	select
    	    	count(*) 
    	from
    	    	dual 
    	where
    	    	exists(
    	    	    	select
    	    	    	    	1 
    	    	    	from
    	    	    	    	glb_gl_report a 
    	    	    	where
    	    	    	    	a.corpno=#org_id# and a.report_type=#report_type# 
    	    	    	    	and a.trxn_date=#trxn_date# and a.branch_id=#branch_id# 
    	    	    	    	and a.ccy_code=#ccy_code# 
                        and a.gl_date_interval in ('1','2')
						and( current_debit_amt<>0.00 or
						current_credit_amt<>0.00 or
						current_debit_bal<>0.00 or
						current_credit_bal<>0.00
						)
    	    	)]]></sql>
        <sql type="mysql"><![CDATA[
     	select
    	    	count(*) 
    	from
    	    	dual 
    	where
    	    	exists(
    	    	    	select
    	    	    	    	1 
    	    	    	from
    	    	    	    	glb_gl_report a 
    	    	    	where
    	    	    	    	a.corpno=#org_id# and a.report_type=#report_type# 
    	    	    	    	and a.trxn_date=#trxn_date# and a.branch_id=#branch_id# 
    	    	    	    	and a.ccy_code=#ccy_code# 
                        and a.gl_date_interval in ('1','2')
						and( current_debit_amt<>0.00 or
						current_credit_amt<>0.00 or
						current_debit_bal<>0.00 or
						current_credit_bal<>0.00
						)
    	    	)]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="report_type" ref="GlDict.A.report_type" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTTYPE" mode="in" longname="报表类型" parameterType="condition"/>
            <parameter property="trxn_date" ref="GlDict.A.trxn_date" jdbcType="VARCHAR" javaType="GlBaseType.U_DATE" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="branch_id" ref="GlDict.A.branch_id" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="机构号" parameterType="condition"/>
            <parameter property="ccy_code" ref="GlDict.A.ccy_code" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="货币代码" parameterType="condition"/>
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="int"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="lstCcyCodeListByBranchId" longname="查询币种根据机构">
        <sql type="oracle"><![CDATA[
    	select
    	    	distinct a.ccy_code , a.branch_id
    	from
    	    	glb_gl_report a 
    	where
    	    	a.corpno=#org_id# and a.report_type=#report_type# 
    	    	and a.branch_id=#branch_id#
    	]]></sql>
        <sql type="db2"><![CDATA[
    	select
    	    	distinct a.ccy_code , a.branch_id
    	from
    	    	glb_gl_report a 
    	where
    	    	a.corpno=#org_id# and a.report_type=#report_type# 
    	    	and a.branch_id=#branch_id#
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	distinct a.ccy_code , a.branch_id
    	from
    	    	glb_gl_report a 
    	where
    	    	a.corpno=#org_id# and a.report_type=#report_type# 
    	    	and a.branch_id=#branch_id#
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="report_type" ref="GlDict.A.report_type" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTTYPE" mode="in" longname="报表类型" parameterType="condition"/>
            <parameter property="branch_id" ref="GlDict.A.branch_id" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="机构号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="GlReport.GlCcyAndBranchList"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="lstReprotDefine" longname="选择报表数据定义">
        <sql type="oracle"><![CDATA[
    	select
    	    	* 
    	from
    	    	glp_report_define a 
    	where
    	    	a.report_name=#report_name# and a.corpno=#org_id# 
    	    	and a.item_data_type in (
    	    	    	'2','3'
    	    	) 
    	order by
    	    	a.report_item_calc_level ,a.report_item_column,a.report_item_line
    	]]></sql>
        <sql type="db2"><![CDATA[
    	select
    	    	* 
    	from
    	    	glp_report_define a 
    	where
    	    	a.report_name=#report_name# and a.corpno=#org_id# 
    	    	and a.item_data_type in (
    	    	    	'2','3'
    	    	) 
    	order by
    	    	a.report_item_calc_level ,a.report_item_column,a.report_item_line
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	* 
    	from
    	    	glp_report_define a 
    	where
    	    	a.report_name=#report_name# and a.corpno=#org_id# 
    	    	and a.item_data_type in (
    	    	    	'2','3'
    	    	) 
    	order by
    	    	a.report_item_calc_level ,a.report_item_column,a.report_item_line
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="report_name" ref="GlDict.A.report_name" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTNAME" mode="in" longname="报表名称" parameterType="condition"/>
        </parameterMap>
        <resultMap class="TabGLReport.glp_report_define"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="lstReprotElement" longname="获取报表要素">
        <sql type="oracle"><![CDATA[
    	select
    	    	* 
    	from
    	    	glp_report_define a 
    	where
    	    	a.report_name=#report_name# and a.corpno=#org_id# 
    	order by
    	    	a.report_item_line ,a.report_item_column
    	]]></sql>
        <sql type="db2"><![CDATA[
    	select
    	    	* 
    	from
    	    	glp_report_define a 
    	where
    	    	a.report_name=#report_name# and a.corpno=#org_id# 
    	order by
    	    	a.report_item_line ,a.report_item_column
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	* 
    	from
    	    	glp_report_define a 
    	where
    	    	a.report_name=#report_name# and a.corpno=#org_id# 
    	order by
    	    	a.report_item_line ,a.report_item_column
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="report_name" ref="GlDict.A.report_name" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTNAME" mode="in" longname="报表名称" parameterType="condition"/>
        </parameterMap>
        <resultMap class="TabGLReport.glp_report_define"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selBalanceByBusiGlByCollectCrebit" longname="按汇总科目贷差业务总账获取项次余额">
        <sql type="mysql"><![CDATA[
    	select
    	    	ifnull((case when sum(a.current_credit_amt - a.current_debit_amt )>= 0 then sum(a.current_credit_amt - a.current_debit_amt) else 0 end), 0.00) as occurrence_margin, ifnull((case when sum(a.current_credit_bal - a.current_debit_bal)>= 0 then sum( a.current_credit_bal-a.current_debit_bal) else 0 end),0.00) as bal_margin 
    	from
    	    	glb_gl_report a 
    	where
    	    	a.trxn_date=#trxn_date# and a.branch_id=#branch_id# 
    	    	and a.ccy_code=#ccy_code# and a.report_type=#report_type# 
    	    	and a.gl_date_interval=#gl_date_interval# and a.corpno=#org_id# 
    	    	and Instr(#netting_item#, concat(',',a.gl_code,','))>0 
    	]]></sql>
        <sql type="oracle"><![CDATA[
    	select
    	    	nvl( (case when sum(a.current_credit_amt - a.current_debit_amt )>= 0 then sum(a.current_credit_amt - a.current_debit_amt) else 0 end), 0.00) as occurrence_margin, nvl((case when sum(a.current_credit_bal - a.current_debit_bal)>= 0 then sum( a.current_credit_bal-a.current_debit_bal) else 0 end),0.00) as bal_margin 
    	from
    	    	glb_gl_report a 
    	where
    	    	a.trxn_date=#trxn_date# and a.branch_id=#branch_id# 
    	    	and a.ccy_code=#ccy_code# and a.report_type=#report_type# 
    	    	and a.gl_date_interval=#gl_date_interval# and a.corpno=#org_id# 
    	    	and Instr(#netting_item#,','|| a.gl_code || ',')>0 
    	]]></sql>
        <sql type="db2"><![CDATA[
    	select
    	    	value( (case when sum(a.current_credit_amt - a.current_debit_amt )>= 0 then sum(a.current_credit_amt - a.current_debit_amt) else 0 end), 0.00) as occurrence_margin, value((case when sum(a.current_credit_bal - a.current_debit_bal)>= 0 then sum( a.current_credit_bal-a.current_debit_bal) else 0 end),0.00) as bal_margin 
    	from
    	    	glb_gl_report a 
    	where
    	    	a.trxn_date=#trxn_date# and a.branch_id=#branch_id# 
    	    	and a.ccy_code=#ccy_code# and a.report_type=#report_type# 
    	    	and a.gl_date_interval=#gl_date_interval# and a.corpno=#org_id# 
    	    	and Instr(#netting_item#,','|| a.gl_code || ',')>0 
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="trxn_date" ref="GlDict.A.trxn_date" jdbcType="VARCHAR" javaType="GlBaseType.U_DATE" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="branch_id" ref="GlDict.A.branch_id" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="机构号" parameterType="condition"/>
            <parameter property="ccy_code" ref="GlDict.A.ccy_code" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="货币代码" parameterType="condition"/>
            <parameter property="report_type" ref="GlDict.A.report_type" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTTYPE" mode="in" longname="报表类型" parameterType="condition"/>
            <parameter property="gl_date_interval" ref="GlDict.A.gl_date_interval" jdbcType="VARCHAR" javaType="GlBusinessType.E_GLDATEINTERVAL" mode="in" longname="总账区间" parameterType="condition"/>
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="netting_item" ref="GlDict.A.netting_item" jdbcType="VARCHAR" javaType="GlBaseType.U_BYTE4000" mode="in" longname="轧差项" parameterType="condition"/>
        </parameterMap>
        <resultMap class="GlReport.GlFactorCal"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selBalanceByBusiGlByCollectDebit" longname="按汇总科目借差业务总账获取项次余额">
        <sql type="mysql"><![CDATA[
    	select
    	    	ifnull( (case when sum(a.current_debit_amt - a.current_credit_amt )>= 0 then sum(a.current_debit_amt - a.current_credit_amt) else 0 end), 0.00) as occurrence_margin, ifnull((case when sum(a.current_debit_bal - a.current_credit_bal)>= 0 then sum( a.current_debit_bal-a.current_credit_bal) else 0 end),0.00) as bal_margin 
    	from
    	    	glb_gl_report a 
    	where
    	    	a.trxn_date=#trxn_date# and a.branch_id=#branch_id# 
    	    	and a.ccy_code=#ccy_code# and a.report_type=#report_type# 
    	    	and a.gl_date_interval=#gl_date_interval# and a.corpno=#org_id# 
    	    	and Instr(#netting_item#,concat(',',a.gl_code,','))>0 
    	]]></sql>
        <sql type="oracle"><![CDATA[  select
          nvl( (case when sum(a.current_debit_amt - a.current_credit_amt )>= 0 
          then sum(a.current_debit_amt - a.current_credit_amt) else 0 end), 0.00) as occurrence_margin,
            nvl((case when sum(a.current_debit_bal - a.current_credit_bal)>= 0 
            then sum( a.current_debit_bal-a.current_credit_bal) else 0 end),0.00) as bal_margin         
          from glb_gl_report a 
          where a.trxn_date=#trxn_date#
          and a.branch_id=#branch_id#
          and a.ccy_code=#ccy_code#
          and a.report_type=#report_type#
          and a.gl_date_interval=#gl_date_interval#
          and a.corpno=#org_id#
        and Instr(#netting_item#,','||  a.gl_code ||',')>0 ]]></sql>
        <sql type="db2"><![CDATA[  select
          value( (case when sum(a.current_debit_amt - a.current_credit_amt )>= 0 
          then sum(a.current_debit_amt - a.current_credit_amt) else 0 end), 0.00) as occurrence_margin,
            value((case when sum(a.current_debit_bal - a.current_credit_bal)>= 0 
            then sum( a.current_debit_bal-a.current_credit_bal) else 0 end),0.00) as bal_margin         
          from glb_gl_report a 
          where a.trxn_date=#trxn_date#
          and a.branch_id=#branch_id#
          and a.ccy_code=#ccy_code#
          and a.report_type=#report_type#
          and a.gl_date_interval=#gl_date_interval#
          and a.corpno=#org_id#
        and Instr(#netting_item#,','||  a.gl_code ||',')>0 ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="trxn_date" ref="GlDict.A.trxn_date" jdbcType="VARCHAR" javaType="GlBaseType.U_DATE" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="branch_id" ref="GlDict.A.branch_id" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="机构号" parameterType="condition"/>
            <parameter property="ccy_code" ref="GlDict.A.ccy_code" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="货币代码" parameterType="condition"/>
            <parameter property="report_type" ref="GlDict.A.report_type" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTTYPE" mode="in" longname="报表类型" parameterType="condition"/>
            <parameter property="gl_date_interval" ref="GlDict.A.gl_date_interval" jdbcType="VARCHAR" javaType="GlBusinessType.E_GLDATEINTERVAL" mode="in" longname="总账区间" parameterType="condition"/>
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="netting_item" ref="GlDict.A.netting_item" jdbcType="VARCHAR" javaType="GlBaseType.U_BYTE4000" mode="in" longname="轧差项" parameterType="condition"/>
        </parameterMap>
        <resultMap class="GlReport.GlFactorCal"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selBalanceByBusiGl" longname="从业务总账获取项次余额">
        <sql type="mysql"><![CDATA[
    	select
    	    	ifnull(sum(a.current_debit_amt - a.current_credit_amt),0.00) as occurrence_margin, ifnull(sum(a.current_debit_bal-a.current_credit_bal),0.00) as bal_margin 
    	from
    	    	glb_gl_report a 
    	where
    	    	a.trxn_date=#trxn_date# and a.branch_id=#branch_id# 
    	    	and a.ccy_code=#ccy_code# and a.report_type=#report_type# 
    	    	and a.gl_date_interval=#gl_date_interval# and a.corpno=#org_id# 
    	    	and Instr(#netting_item#, concat(',' , a.gl_code ,','))> 0
    	]]></sql>
        <sql type="oracle"><![CDATA[    select nvl(sum(a.current_debit_amt - a.current_credit_amt),0.00) as occurrence_margin, 
          nvl(sum(a.current_debit_bal-a.current_credit_bal),0.00) as bal_margin
          from glb_gl_report a 
          where a.trxn_date=#trxn_date#
          and a.branch_id=#branch_id#
          and a.ccy_code=#ccy_code#
          and a.report_type=#report_type#
          and a.gl_date_interval=#gl_date_interval#
          and a.corpno=#org_id#
          and Instr(#netting_item#,',' || a.gl_code ||',')> 0]]></sql>
        <sql type="db2"><![CDATA[    select value(sum(a.current_debit_amt - a.current_credit_amt),0.00) as occurrence_margin, 
          value(sum(a.current_debit_bal-a.current_credit_bal),0.00) as bal_margin
          from glb_gl_report a 
          where a.trxn_date=#trxn_date#
          and a.branch_id=#branch_id#
          and a.ccy_code=#ccy_code#
          and a.report_type=#report_type#
          and a.gl_date_interval=#gl_date_interval#
          and a.corpno=#org_id#
          and Instr(#netting_item#,',' || a.gl_code ||',')> 0]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="trxn_date" ref="GlDict.A.trxn_date" jdbcType="VARCHAR" javaType="GlBaseType.U_DATE" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="branch_id" ref="GlDict.A.branch_id" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="机构号" parameterType="condition"/>
            <parameter property="ccy_code" ref="GlDict.A.ccy_code" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="货币代码" parameterType="condition"/>
            <parameter property="report_type" ref="GlDict.A.report_type" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTTYPE" mode="in" longname="报表类型" parameterType="condition"/>
            <parameter property="gl_date_interval" ref="GlDict.A.gl_date_interval" jdbcType="VARCHAR" javaType="GlBusinessType.E_GLDATEINTERVAL" mode="in" longname="总账区间" parameterType="condition"/>
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="netting_item" ref="GlDict.A.netting_item" jdbcType="VARCHAR" javaType="GlBaseType.U_BYTE4000" mode="in" longname="轧差项" parameterType="condition"/>
        </parameterMap>
        <resultMap class="GlReport.GlFactorCal"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selBalanceByBusiGlBySubjectDebit" longname="按科目借差业务总账获取项次余额">
        <sql type="mysql"><![CDATA[     select 
          ifnull((case when sum(a.current_debit_amt - a.current_credit_amt) >= 0 
          then sum(a.current_debit_amt-a.current_credit_amt) else 0 end), 0.00) as occurrence_margin,
            ifnull((case when sum(a.current_debit_bal-a.current_credit_bal) >= 0
            then sum(a.current_debit_bal-a.current_credit_bal) else 0 end), 0.00) as bal_margin
          from glb_gl_report a
          where a.trxn_date=#trxn_date#
          and a.branch_id=#branch_id#
          and a.ccy_code=#ccy_code#
          and a.report_type=#report_type#
          and a.gl_date_interval=#gl_date_interval#
          and a.corpno=#org_id#
          and Instr(#netting_item#, concat(',',a.gl_code,','))> 0]]></sql>
        <sql type="oracle"><![CDATA[     select 
          nvl((case when sum(a.current_debit_amt - a.current_credit_amt) >= 0 
          then sum(a.current_debit_amt-a.current_credit_amt) else 0 end), 0.00) as occurrence_margin,
            nvl((case when sum(a.current_debit_bal-a.current_credit_bal) >= 0
            then sum(a.current_debit_bal-a.current_credit_bal) else 0 end), 0.00) as bal_margin
          from glb_gl_report a
          where a.trxn_date=#trxn_date#
          and a.branch_id=#branch_id#
          and a.ccy_code=#ccy_code#
          and a.report_type=#report_type#
          and a.gl_date_interval=#gl_date_interval#
          and a.corpno=#org_id#
          and Instr(#netting_item#,',' || a.gl_code ||',')> 0]]></sql>
        <sql type="db2"><![CDATA[     select 
          value((case when sum(a.current_debit_amt - a.current_credit_amt) >= 0 
          then sum(a.current_debit_amt-a.current_credit_amt) else 0 end), 0.00) as occurrence_margin,
            value((case when sum(a.current_debit_bal-a.current_credit_bal) >= 0
            then sum(a.current_debit_bal-a.current_credit_bal) else 0 end), 0.00) as bal_margin
          from glb_gl_report a
          where a.trxn_date=#trxn_date#
          and a.branch_id=#branch_id#
          and a.ccy_code=#ccy_code#
          and a.report_type=#report_type#
          and a.gl_date_interval=#gl_date_interval#
          and a.corpno=#org_id#
          and Instr(#netting_item#,',' || a.gl_code ||',')> 0]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="trxn_date" ref="GlDict.A.trxn_date" jdbcType="VARCHAR" javaType="GlBaseType.U_DATE" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="branch_id" ref="GlDict.A.branch_id" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="机构号" parameterType="condition"/>
            <parameter property="ccy_code" ref="GlDict.A.ccy_code" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="货币代码" parameterType="condition"/>
            <parameter property="report_type" ref="GlDict.A.report_type" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTTYPE" mode="in" longname="报表类型" parameterType="condition"/>
            <parameter property="gl_date_interval" ref="GlDict.A.gl_date_interval" jdbcType="VARCHAR" javaType="GlBusinessType.E_GLDATEINTERVAL" mode="in" longname="总账区间" parameterType="condition"/>
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="netting_item" ref="GlDict.A.netting_item" jdbcType="VARCHAR" javaType="GlBaseType.U_BYTE4000" mode="in" longname="轧差项" parameterType="condition"/>
        </parameterMap>
        <resultMap class="GlReport.GlFactorCal"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selBalanceByBusiGlBySubjectCrebit" longname="按科目贷差业务总账获取项次余额">
        <sql type="mysql"><![CDATA[
    	select
    	    	ifnull(sum(case when (a.current_credit_amt - a.current_debit_amt) >= 0 then (a.current_credit_amt - a.current_debit_amt) else 0 end), 0.00) as occurrence_margin, ifnull(sum(case when (a.current_credit_bal - a.current_debit_bal) >= 0 then (a.current_credit_bal - a.current_debit_bal) else 0 end), 0.00) as bal_margin 
    	from
    	    	glb_gl_report a 
    	where
    	    	a.trxn_date=#trxn_date# and a.branch_id=#branch_id# 
    	    	and a.ccy_code=#ccy_code# and a.report_type=#report_type# 
    	    	and a.gl_date_interval=#gl_date_interval# and a.corpno=#org_id# 
    	    	and Instr(#netting_item#,concat(',',a.gl_code, ','))> 0
    	]]></sql>
        <sql type="oracle"><![CDATA[ select 
          nvl(sum(case when (a.current_credit_amt - a.current_debit_amt) >= 0 
          then (a.current_credit_amt - a.current_debit_amt) else 0 end), 0.00) as occurrence_margin,
            nvl(sum(case when (a.current_credit_bal - a.current_debit_bal) >= 0
            then (a.current_credit_bal - a.current_debit_bal) else 0 end), 0.00) as bal_margin
          from glb_gl_report a
          where a.trxn_date=#trxn_date#
          and a.branch_id=#branch_id#
          and a.ccy_code=#ccy_code#
          and a.report_type=#report_type#
          and a.gl_date_interval=#gl_date_interval#
          and a.corpno=#org_id#
          and Instr(#netting_item#,',' || a.gl_code || ',')> 0]]></sql>
        <sql type="db2"><![CDATA[ select 
          value(sum(case when (a.current_credit_amt - a.current_debit_amt) >= 0 
          then (a.current_credit_amt - a.current_debit_amt) else 0 end), 0.00) as occurrence_margin,
            value(sum(case when (a.current_credit_bal - a.current_debit_bal) >= 0
            then (a.current_credit_bal - a.current_debit_bal) else 0 end), 0.00) as bal_margin
          from glb_gl_report a
          where a.trxn_date=#trxn_date#
          and a.branch_id=#branch_id#
          and a.ccy_code=#ccy_code#
          and a.report_type=#report_type#
          and a.gl_date_interval=#gl_date_interval#
          and a.corpno=#org_id#
          and Instr(#netting_item#,',' || a.gl_code || ',')> 0]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="trxn_date" ref="GlDict.A.trxn_date" jdbcType="VARCHAR" javaType="GlBaseType.U_DATE" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="branch_id" ref="GlDict.A.branch_id" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="机构号" parameterType="condition"/>
            <parameter property="ccy_code" ref="GlDict.A.ccy_code" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="货币代码" parameterType="condition"/>
            <parameter property="report_type" ref="GlDict.A.report_type" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTTYPE" mode="in" longname="报表类型" parameterType="condition"/>
            <parameter property="gl_date_interval" ref="GlDict.A.gl_date_interval" jdbcType="VARCHAR" javaType="GlBusinessType.E_GLDATEINTERVAL" mode="in" longname="总账区间" parameterType="condition"/>
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="netting_item" ref="GlDict.A.netting_item" jdbcType="VARCHAR" javaType="GlBaseType.U_BYTE4000" mode="in" longname="轧差项" parameterType="condition"/>
        </parameterMap>
        <resultMap class="GlReport.GlFactorCal"/>
    </select>
    <select cache="none" method="selectOne" type="sql" id="selBalanceFromReportResult" longname="从报表计算结果获取项次余额">
        <sql type="mysql"><![CDATA[
    	select
    	    	ifnull(sum(a.cur_term_amt),0.00) as occurrence_margin, ifnull(sum(a.add_up_amt),0.00) as bal_margin 
    	from
    	    	glb_report_calc_result a 
    	where
    	    	a.trxn_date=#trxn_date# and a.branch_id=#branch_id# 
    	    	and a.report_type=#report_type# and a.report_name=#report_name# 
    	    	and a.ccy_code=#ccy_code# and a.corpno=#org_id# 
    	    	and Instr(#report_item_no#, concat(',',a.report_item_no ,','))>0
    	]]></sql>
        <sql type="oracle"><![CDATA[
    	select
    	    	nvl(sum(a.cur_term_amt),0.00) as occurrence_margin, nvl(sum(a.add_up_amt),0.00) as bal_margin 
    	from
    	    	glb_report_calc_result a 
    	where
    	    	a.trxn_date=#trxn_date# and a.branch_id=#branch_id# 
    	    	and a.report_type=#report_type# and a.report_name=#report_name# 
    	    	and a.ccy_code=#ccy_code# and a.corpno=#org_id# 
    	    	and Instr(#report_item_no#,',' || a.report_item_no || ',')>0
    	]]></sql>
        <sql type="db2"><![CDATA[
    	select
    	    	value(sum(a.cur_term_amt),0.00) as occurrence_margin, value(sum(a.add_up_amt),0.00) as bal_margin 
    	from
    	    	glb_report_calc_result a 
    	where
    	    	a.trxn_date=#trxn_date# and a.branch_id=#branch_id# 
    	    	and a.report_type=#report_type# and a.report_name=#report_name# 
    	    	and a.ccy_code=#ccy_code# and a.corpno=#org_id# 
    	    	and Instr(#report_item_no#,',' || a.report_item_no || ',')>0
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="trxn_date" ref="GlDict.A.trxn_date" jdbcType="VARCHAR" javaType="GlBaseType.U_DATE" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="branch_id" ref="GlDict.A.branch_id" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="机构号" parameterType="condition"/>
            <parameter property="report_type" ref="GlDict.A.report_type" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTTYPE" mode="in" longname="报表类型" parameterType="condition"/>
            <parameter property="report_name" ref="GlDict.A.report_name" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTNAME" mode="in" longname="报表名称" parameterType="condition"/>
            <parameter property="ccy_code" ref="GlDict.A.ccy_code" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="currency code" parameterType="condition"/>
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="report_item_no" ref="GlDict.A.report_item_no" jdbcType="VARCHAR" javaType="GlBaseType.U_BYTE4" mode="in" longname="报表项次编号" parameterType="condition"/>
        </parameterMap>
        <resultMap class="GlReport.GlFactorCal"/>
    </select>
    <insert id="insMonthReportResults" longname="生成月总账报表数据结果">
        <sql type="oracle"><![CDATA[insert 
    	into
    	    	glb_report_calc_result
    	    	(
    	    	    	corpno,recdver,report_name,report_type,trxn_date,branch_id,gl_date_interval, ccy_code,report_item_no,cur_term_amt,add_up_amt 
    	    	) select
    	    	    	corpno,'0',report_name,report_type,#trxn_date#,branch_id,
    	    	    	'2', ccy_code,report_item_no, sum(cur_term_amt),sum(case when trxn_date = #end_date# then add_up_amt else 0.00 end ) 
    	    	from
    	    	    	glb_report_calc_result a 
    	    	where
    	    	    	a.trxn_date between #start_date# and #end_date# and a.corpno=#org_id# 
    	    	    	and a.report_name=#report_name# and a.gl_date_interval='1' 
    	    	    	and a.branch_id=#branch_id# and a.report_type=#report_type# 
    	    	group by
    	    	    	corpno,
    	    	    	report_name ,branch_id ,report_type ,ccy_code,report_item_no]]></sql>
        <sql type="db2"><![CDATA[insert 
    	into
    	    	glb_report_calc_result
    	    	(
    	    	    	corpno,recdver,report_name,report_type,trxn_date,branch_id,gl_date_interval, ccy_code,report_item_no,cur_term_amt,add_up_amt 
    	    	) select
    	    	    	corpno,'0',report_name,report_type,#trxn_date#,branch_id,
    	    	    	'2', ccy_code,report_item_no, sum(cur_term_amt),sum(case when trxn_date = #end_date# then add_up_amt else 0.00 end ) 
    	    	from
    	    	    	glb_report_calc_result a 
    	    	where
    	    	    	a.trxn_date between #start_date# and #end_date# and a.corpno=#org_id# 
    	    	    	and a.report_name=#report_name# and a.gl_date_interval='1' 
    	    	    	and a.branch_id=#branch_id# and a.report_type=#report_type# 
    	    	group by
    	    	    	corpno,
    	    	    	report_name ,branch_id ,report_type ,ccy_code,report_item_no]]></sql>
        <sql type="mysql"><![CDATA[insert 
    	into
    	    	glb_report_calc_result
    	    	(
    	    	    	corpno,recdver,report_name,report_type,trxn_date,branch_id,gl_date_interval, ccy_code,report_item_no,cur_term_amt,add_up_amt 
    	    	) select
    	    	    	corpno,'0',report_name,report_type,#trxn_date#,branch_id,
    	    	    	'2', ccy_code,report_item_no, sum(cur_term_amt),sum(case when trxn_date = #end_date# then add_up_amt else 0.00 end ) 
    	    	from
    	    	    	glb_report_calc_result a 
    	    	where
    	    	    	a.trxn_date between #start_date# and #end_date# and a.corpno=#org_id# 
    	    	    	and a.report_name=#report_name# and a.gl_date_interval='1' 
    	    	    	and a.branch_id=#branch_id# and a.report_type=#report_type# 
    	    	group by
    	    	    	corpno,
    	    	    	report_name ,branch_id ,report_type ,ccy_code,report_item_no]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="report_type" ref="GlDict.A.report_type" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTTYPE" mode="in" longname="报表类型" parameterType="condition"/>
            <parameter property="report_name" ref="GlDict.A.report_name" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTNAME" mode="in" longname="报表名称" parameterType="condition"/>
            <parameter property="branch_id" ref="GlDict.A.branch_id" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="机构号" parameterType="condition"/>
            <parameter property="start_date" ref="GlDict.A.start_date" jdbcType="VARCHAR" javaType="GlBaseType.U_DATE" mode="in" longname="起始日期" parameterType="condition"/>
            <parameter property="end_date" ref="GlDict.A.end_date" jdbcType="VARCHAR" javaType="GlBaseType.U_DATE" mode="in" longname="截止日期" parameterType="condition"/>
            <parameter property="trxn_date" ref="GlDict.A.trxn_date" jdbcType="VARCHAR" javaType="GlBaseType.U_DATE" mode="in" longname="交易日期" parameterType="condition"/>
        </parameterMap>
    </insert>
    <delete method="delete" id="delBalanceSheet" longname="删除资产负债表数据">
        <sql type="mysql"><![CDATA[
    	delete a
    	from
    	    	glb_balance_sheet a 
    	where
    	    	a.corpno=#org_id# and a.report_type=#report_type# 
    	    	and a.branch_id=#branch_id# and a.trxn_date=#trxn_date# 
    	]]></sql>
        <sql type="oracle"><![CDATA[
    	delete 
    	from
    	    	glb_balance_sheet
    	where
    	    	corpno=#org_id# and report_type=#report_type# 
    	    	and branch_id=#branch_id# and trxn_date=#trxn_date# 
    	]]></sql>
        <sql type="db2"><![CDATA[
    	delete 
    	from
    	    	glb_balance_sheet
    	where
    	    	corpno=#org_id# and report_type=#report_type# 
    	    	and branch_id=#branch_id# and trxn_date=#trxn_date# 
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="report_type" ref="GlDict.A.report_type" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTTYPE" mode="in" longname="报表类型" parameterType="condition"/>
            <parameter property="branch_id" ref="GlDict.A.branch_id" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="机构号" parameterType="condition"/>
            <parameter property="trxn_date" ref="GlDict.A.trxn_date" jdbcType="VARCHAR" javaType="GlBaseType.U_DATE" mode="in" longname="交易日期" parameterType="condition"/>
        </parameterMap>
    </delete>
    <select cache="none" method="selectOne" type="sql" id="lstReportData" longname="查询报表数据">
        <sql type="mysql"><![CDATA[
    	select
    	   ifnull(sum(a.cur_term_amt),0) as cur_term_amt,
    	   ifnull(sum(case when a.trxn_date = #end_date# then a.add_up_amt else 0 end), 0) as add_up_amt
    	from
    	    	glb_report_calc_result a 
    	where
    	    	a.trxn_date between #start_date# and #end_date# and a.corpno = #org_id# 
    	    	and a.report_name = #report_name# and a.branch_id = #branch_id# 
    	    	and a.report_type = #report_type# and a.ccy_code = #ccy_code# 
    	    	and a.report_item_no = #report_item_no# and a.gl_date_interval = #gl_date_interval# 
    	]]></sql>
        <sql type="oracle"><![CDATA[ select nvl(sum(a.cur_term_amt),0.00) as cur_term_amt,
  nvl(sum(case when a.trxn_date=#end_date# then a.add_up_amt else 0.00 end) , 0.00 ) as add_up_amt
 
 from glb_report_calc_result a
 where a.trxn_date between #start_date# and #end_date#
 and a.corpno =  #org_id#
 and a.report_name = #report_name#
 and a.branch_id = #branch_id#
 and a.report_type = #report_type#
 and a.ccy_code = #ccy_code#
 and a.report_item_no = #report_item_no#
 and a.gl_date_interval = #gl_date_interval#
     ]]></sql>
        <sql type="db2"><![CDATA[ select value(sum(a.cur_term_amt),0.00) as cur_term_amt,
  value(sum(case when a.trxn_date=#end_date# then a.add_up_amt else 0.00 end) , 0.00 ) as add_up_amt
 
 from glb_report_calc_result a
 where a.trxn_date between #start_date# and #end_date#
 and a.corpno =  #org_id#
 and a.report_name = #report_name#
 and a.branch_id = #branch_id#
 and a.report_type = #report_type#
 and a.ccy_code = #ccy_code#
 and a.report_item_no = #report_item_no#
 and a.gl_date_interval = #gl_date_interval#
     ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="report_type" ref="GlDict.A.report_type" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTTYPE" mode="in" longname="报表类型" parameterType="condition"/>
            <parameter property="report_name" ref="GlDict.A.report_name" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTNAME" mode="in" longname="报表名称" parameterType="condition"/>
            <parameter property="branch_id" ref="GlDict.A.branch_id" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="机构号" parameterType="condition"/>
            <parameter property="ccy_code" ref="GlDict.A.ccy_code" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="货币代码" parameterType="condition"/>
            <parameter property="gl_date_interval" ref="GlDict.A.gl_date_interval" jdbcType="VARCHAR" javaType="GlBusinessType.E_GLDATEINTERVAL" mode="in" longname="总账区间" parameterType="condition"/>
            <parameter property="report_item_no" ref="GlDict.A.report_item_no" jdbcType="VARCHAR" javaType="GlBaseType.U_BYTE4" mode="in" longname="报表项次编号" parameterType="condition"/>
            <parameter property="start_date" ref="GlDict.A.start_date" jdbcType="VARCHAR" javaType="GlBaseType.U_DATE" mode="in" longname="起始日期" parameterType="condition"/>
            <parameter property="end_date" ref="GlDict.A.end_date" jdbcType="VARCHAR" javaType="GlBaseType.U_DATE" mode="in" longname="截止日期" parameterType="condition"/>
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="GlReport.GlReportData"/>
    </select>
    <delete method="delete" id="delIncomeTable" longname="删除损益明细表数据">
        <sql type="mysql"><![CDATA[
    	delete a
    	from
    	    	glb_income_statement a 
    	where
    	    	a.corpno = #org_id# and a.trxn_date = #trxn_date# 
    	    	and a.report_type = #report_type# and a.branch_id = #branch_id# 
    	]]></sql>
        <sql type="oracle"><![CDATA[
           
       delete from glb_income_statement
       where corpno = #org_id#
       and trxn_date = #trxn_date#
       and report_type = #report_type#
       and branch_id = #branch_id#
 ]]></sql>
        <sql type="db2"><![CDATA[
           
       delete from glb_income_statement
       where corpno = #org_id#
       and trxn_date = #trxn_date#
       and report_type = #report_type#
       and branch_id = #branch_id#
 ]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="trxn_date" ref="GlDict.A.trxn_date" jdbcType="VARCHAR" javaType="GlBaseType.U_DATE" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="report_type" ref="GlDict.A.report_type" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTTYPE" mode="in" longname="报表类型" parameterType="condition"/>
            <parameter property="branch_id" ref="GlDict.A.branch_id" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="机构号" parameterType="condition"/>
        </parameterMap>
    </delete>
    <delete method="delete" id="delProfit" longname="删除利润表数据">
        <sql type="mysql"><![CDATA[
    	delete a
    	from
    	    	glb_profit_sheet a 
    	where
    	    	a.corpno = #org_id# and a.report_type = #report_type# 
    	    	and a.trxn_date = #trxn_date# and a.branch_id = #branch_id#
    	]]></sql>
        <sql type="oracle"><![CDATA[ 
        delete from glb_profit_sheet a 
		 where a.corpno =  #org_id#
		 and a.report_type = #report_type#
		 and a.trxn_date = #trxn_date#
		 and a.branch_id = #branch_id#]]></sql>
        <sql type="db2"><![CDATA[ 
        delete from glb_profit_sheet a 
		 where a.corpno =  #org_id#
		 and a.report_type = #report_type#
		 and a.trxn_date = #trxn_date#
		 and a.branch_id = #branch_id#]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
            <parameter property="report_type" ref="GlDict.A.report_type" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTTYPE" mode="in" longname="报表类型" parameterType="condition"/>
            <parameter property="trxn_date" ref="GlDict.A.trxn_date" jdbcType="VARCHAR" javaType="GlBaseType.U_DATE" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="branch_id" ref="GlDict.A.branch_id" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="机构号" parameterType="condition"/>
        </parameterMap>
    </delete>
    <select cache="none" method="selectAll" type="sql" id="lstBalanceData" longname="获取资产负债表数据">
        <sql type="oracle"><![CDATA[select * from glb_balance_sheet a 
where a.corpno=#org_id#
and a.branch_id=#branch_id#
and a.ccy_code=#ccy_code#
and a.trxn_date=#trxn_date#
and a.gl_date_interval=#gl_date_interval#
and a.report_type=#report_type#
order by a.ccy_code,a.report_item_line]]></sql>
        <sql type="db2"><![CDATA[select * from glb_balance_sheet a 
where a.corpno=#org_id#
and a.branch_id=#branch_id#
and a.ccy_code=#ccy_code#
and a.trxn_date=#trxn_date#
and a.gl_date_interval=#gl_date_interval#
and a.report_type=#report_type#
order by a.ccy_code,a.report_item_line]]></sql>
        <sql type="mysql"><![CDATA[select * from glb_balance_sheet a 
where a.corpno=#org_id#
and a.branch_id=#branch_id#
and a.ccy_code=#ccy_code#
and a.trxn_date=#trxn_date#
and a.gl_date_interval=#gl_date_interval#
and a.report_type=#report_type#
order by a.ccy_code,a.report_item_line]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="organization id" parameterType="condition"/>
            <parameter property="branch_id" ref="GlDict.A.branch_id" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="branch id" parameterType="condition"/>
            <parameter property="ccy_code" ref="GlDict.A.ccy_code" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="currency code" parameterType="condition"/>
            <parameter property="trxn_date" ref="GlDict.A.trxn_date" jdbcType="VARCHAR" javaType="GlBaseType.U_DATE" mode="in" longname="transaction date" parameterType="condition"/>
            <parameter property="gl_date_interval" ref="GlDict.A.gl_date_interval" jdbcType="VARCHAR" javaType="GlBusinessType.E_GLDATEINTERVAL" mode="in" longname="总账区间" parameterType="condition"/>
            <parameter property="report_type" ref="GlDict.A.report_type" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTTYPE" mode="in" longname="报表类型" parameterType="condition"/>
        </parameterMap>
        <resultMap class="GlReport.GlBalanceSheetOut"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="lstIncome" longname="the data of income statement">
        <sql type="oracle"><![CDATA[
    	select
    	    	* 
    	from
    	    	glb_income_statement a 
    	where
    	    	a.corpno=#org_id# and a.branch_id=#branch_id# 
    	    	and a.ccy_code=#ccy_code# and a.trxn_date=#trxn_date# 
    	    	and a.gl_date_interval=#gl_date_interval# and a.report_type=#report_type# 
    	order by
    	    	a.ccy_code,a.report_item_line 
    	]]></sql>
        <sql type="db2"><![CDATA[
    	select
    	    	* 
    	from
    	    	glb_income_statement a 
    	where
    	    	a.corpno=#org_id# and a.branch_id=#branch_id# 
    	    	and a.ccy_code=#ccy_code# and a.trxn_date=#trxn_date# 
    	    	and a.gl_date_interval=#gl_date_interval# and a.report_type=#report_type# 
    	order by
    	    	a.ccy_code,a.report_item_line 
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	* 
    	from
    	    	glb_income_statement a 
    	where
    	    	a.corpno=#org_id# and a.branch_id=#branch_id# 
    	    	and a.ccy_code=#ccy_code# and a.trxn_date=#trxn_date# 
    	    	and a.gl_date_interval=#gl_date_interval# and a.report_type=#report_type# 
    	order by
    	    	a.ccy_code,a.report_item_line 
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="organization id" parameterType="condition"/>
            <parameter property="branch_id" ref="GlDict.A.branch_id" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="branch id" parameterType="condition"/>
            <parameter property="ccy_code" ref="GlDict.A.ccy_code" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="currency code" parameterType="condition"/>
            <parameter property="trxn_date" ref="GlDict.A.trxn_date" jdbcType="VARCHAR" javaType="GlBaseType.U_DATE" mode="in" longname="transaction date" parameterType="condition"/>
            <parameter property="gl_date_interval" ref="GlDict.A.gl_date_interval" jdbcType="VARCHAR" javaType="GlBusinessType.E_GLDATEINTERVAL" mode="in" longname="总账区间" parameterType="condition"/>
            <parameter property="report_type" ref="GlDict.A.report_type" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTTYPE" mode="in" longname="报表类型" parameterType="condition"/>
        </parameterMap>
        <resultMap class="GlReport.GlIncomeOut"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="lstProfitSheet" longname="the data of profit sheet">
        <sql type="oracle"><![CDATA[
    	select
    	    	* 
    	from
    	    	glb_profit_sheet a 
    	where
    	    	a.corpno=#org_id# and a.branch_id=#branch_id# 
    	    	and a.ccy_code=#ccy_code# AND a.trxn_date=#trxn_date# 
    	    	and a.gl_date_interval=#gl_date_interval# and a.report_type=#report_type# 
    	order by
    	    	a.ccy_code,a.report_item_line 
    	]]></sql>
        <sql type="db2"><![CDATA[
    	select
    	    	* 
    	from
    	    	glb_profit_sheet a 
    	where
    	    	a.corpno=#org_id# and a.branch_id=#branch_id# 
    	    	and a.ccy_code=#ccy_code# AND a.trxn_date=#trxn_date# 
    	    	and a.gl_date_interval=#gl_date_interval# and a.report_type=#report_type# 
    	order by
    	    	a.ccy_code,a.report_item_line 
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	* 
    	from
    	    	glb_profit_sheet a 
    	where
    	    	a.corpno=#org_id# and a.branch_id=#branch_id# 
    	    	and a.ccy_code=#ccy_code# AND a.trxn_date=#trxn_date# 
    	    	and a.gl_date_interval=#gl_date_interval# and a.report_type=#report_type# 
    	order by
    	    	a.ccy_code,a.report_item_line 
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="organization id" parameterType="condition"/>
            <parameter property="branch_id" ref="GlDict.A.branch_id" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="branch id" parameterType="condition"/>
            <parameter property="ccy_code" ref="GlDict.A.ccy_code" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="currency code" parameterType="condition"/>
            <parameter property="trxn_date" ref="GlDict.A.trxn_date" jdbcType="VARCHAR" javaType="GlBaseType.U_DATE" mode="in" longname="transaction date" parameterType="condition"/>
            <parameter property="gl_date_interval" ref="GlDict.A.gl_date_interval" jdbcType="VARCHAR" javaType="GlBusinessType.E_GLDATEINTERVAL" mode="in" longname="总账区间" parameterType="condition"/>
            <parameter property="report_type" ref="GlDict.A.report_type" jdbcType="VARCHAR" javaType="GlBusinessType.E_REPORTTYPE" mode="in" longname="报表类型" parameterType="condition"/>
        </parameterMap>
        <resultMap class="GlReport.GlProfit"/>
    </select>
    <select cache="none" method="selectAll" type="sql" id="lstInsideGenl" longname="select data for business condition">
        <sql type="oracle"><![CDATA[
    	select
    	    	* 
    	from
    	    	glb_gl_report a 
    	where
    	    	a.corpno=#org_id# and a.branch_id=#branch_id# 
    	    	and a.ccy_code=#ccy_code# and a.trxn_date=#trxn_date# 
    	    	and a.gl_date_interval=#gl_date_interval# and a.on_bal_sheet_ind=#on_bal_sheet_ind# 
    	order by
    	    	a.ccy_code,a.gl_code
    	]]></sql>
        <sql type="db2"><![CDATA[
    	select
    	    	* 
    	from
    	    	glb_gl_report a 
    	where
    	    	a.corpno=#org_id# and a.branch_id=#branch_id# 
    	    	and a.ccy_code=#ccy_code# and a.trxn_date=#trxn_date# 
    	    	and a.gl_date_interval=#gl_date_interval# and a.on_bal_sheet_ind=#on_bal_sheet_ind# 
    	order by
    	    	a.ccy_code,a.gl_code
    	]]></sql>
        <sql type="mysql"><![CDATA[
    	select
    	    	* 
    	from
    	    	glb_gl_report a 
    	where
    	    	a.corpno=#org_id# and a.branch_id=#branch_id# 
    	    	and a.ccy_code=#ccy_code# and a.trxn_date=#trxn_date# 
    	    	and a.gl_date_interval=#gl_date_interval# and a.on_bal_sheet_ind=#on_bal_sheet_ind# 
    	order by
    	    	a.ccy_code,a.gl_code
    	]]></sql>
        <parameterMap class="java.util.Map">
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="organization id" parameterType="condition"/>
            <parameter property="branch_id" ref="GlDict.A.branch_id" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="branch id" parameterType="condition"/>
            <parameter property="ccy_code" ref="GlDict.A.ccy_code" jdbcType="VARCHAR" javaType="BaseType.U_CRCYCD" mode="in" longname="currency code" parameterType="condition"/>
            <parameter property="trxn_date" ref="GlDict.A.trxn_date" jdbcType="VARCHAR" javaType="GlBaseType.U_DATE" mode="in" longname="transaction date" parameterType="condition"/>
            <parameter property="gl_date_interval" ref="GlDict.A.gl_date_interval" jdbcType="VARCHAR" javaType="GlBusinessType.E_GLDATEINTERVAL" mode="in" longname="总账区间" parameterType="condition"/>
            <parameter property="on_bal_sheet_ind" ref="GlDict.A.on_bal_sheet_ind" jdbcType="VARCHAR" javaType="GlEnumType.E_YESORNO" mode="in" longname="表内标志" parameterType="condition"/>
        </parameterMap>
        <resultMap class="GlReport.GlBuinessCondition"/>
    </select>
    <dynamicSelect cache="none" method="selectPageWithCount" type="sql" id="lstGlsReport" longname="报表查询">
        <parameterMap class="java.util.Map">
            <parameter property="trxndt" jdbcType="VARCHAR" javaType="GlBaseType.U_DATE" mode="in" longname="交易日期" parameterType="condition"/>
            <parameter property="brchno" jdbcType="VARCHAR" javaType="BaseType.U_BRCHNO" mode="in" longname="机构号" parameterType="condition"/>
            <parameter property="org_id" ref="GlDict.A.org_id" jdbcType="VARCHAR" javaType="BaseType.U_CORPNO" mode="in" longname="法人代码" parameterType="condition"/>
        </parameterMap>
        <resultMap class="TabGLReport.gls_report"/>
        <dynamicSql type="oracle">
            <str type="Str"><![CDATA[select * from gls_report]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[corpno = #org_id#]]></str>
                    <str type="Str"><![CDATA[trxn_date = #trxndt#]]></str>
                    <if test="brchno != null &amp; brchno != ''" type="If">
                        <str type="Str"><![CDATA[branch_id = #brchno#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by branch_id]]></str>
        </dynamicSql>
        <dynamicSql type="mysql">
            <str type="Str"><![CDATA[select * from gls_report]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[corpno = #org_id#]]></str>
                    <str type="Str"><![CDATA[trxn_date = #trxndt#]]></str>
                    <if test="brchno != null &amp; brchno != ''" type="If">
                        <str type="Str"><![CDATA[branch_id = #brchno#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by branch_id]]></str>
        </dynamicSql>
        <dynamicSql type="db2">
            <str type="Str"><![CDATA[select * from gls_report]]></str>
            <where type="Where">
                <and type="And">
                    <str type="Str"><![CDATA[corpno = #org_id#]]></str>
                    <str type="Str"><![CDATA[trxn_date = #trxndt#]]></str>
                    <if test="brchno != null &amp; brchno != ''" type="If">
                        <str type="Str"><![CDATA[branch_id = #brchno#]]></str>
                    </if>
                </and>
            </where>
            <str type="Str"><![CDATA[order by branch_id]]></str>
        </dynamicSql>
    </dynamicSelect>
</sqls>
